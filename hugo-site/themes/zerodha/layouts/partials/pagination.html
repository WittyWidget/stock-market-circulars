{{/* 
  Unified Pagination Partial
  Usage: {{ partial "pagination.html" .Paginator }}
  Optional context variables:
  - .itemType (default: "items") - what to call the paginated items
*/}}
{{ $paginator := . }}
{{ $itemType := "items" }}

{{ if gt $paginator.TotalPages 1 }}
<div class="pagination-section">
    <!-- Pagination Info -->
    <div class="pagination-info">
        Showing {{ add (mul (sub $paginator.PageNumber 1) $paginator.PagerSize) 1 }} - {{ if lt (mul $paginator.PageNumber $paginator.PagerSize) $paginator.TotalNumberOfElements }}{{ mul $paginator.PageNumber $paginator.PagerSize }}{{ else }}{{ $paginator.TotalNumberOfElements }}{{ end }} of {{ $paginator.TotalNumberOfElements }} {{ $itemType }}
    </div>
    
    <!-- Pagination Controls -->
    <div class="pagination-controls">
        {{ if $paginator.HasPrev }}
        <a href="{{ $paginator.Prev.URL }}" class="pagination-button pagination-button-secondary">
            <svg class="pagination-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Previous
        </a>
        {{ else }}
        <button class="pagination-button pagination-button-disabled">
            <svg class="pagination-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Previous
        </button>
        {{ end }}
        
        <!-- Page Numbers with smart truncation -->
        {{ $currentPage := $paginator.PageNumber }}
        {{ $totalPages := $paginator.TotalPages }}
        {{ $maxVisible := 5 }}
        {{ $halfVisible := div $maxVisible 2 }}
        
        {{ $startPage := math.Max 1 (sub $currentPage $halfVisible) }}
        {{ $endPage := math.Min $totalPages (add $startPage (sub $maxVisible 1)) }}
        {{ $startPage := math.Max 1 (sub $endPage (sub $maxVisible 1)) }}
        
        <!-- Show first page if not in range -->
        {{ if gt $startPage 1 }}
        <a href="{{ (index $paginator.Pagers 0).URL }}" class="pagination-button pagination-button-secondary">1</a>
        {{ if gt $startPage 2 }}
        <button class="pagination-button pagination-button-disabled">...</button>
        {{ end }}
        {{ end }}
        
        <!-- Show page numbers in range -->
        {{ range $paginator.Pagers }}
            {{ if and (ge .PageNumber $startPage) (le .PageNumber $endPage) }}
                {{ if eq . $paginator }}
                <button class="pagination-button pagination-button-active">{{ .PageNumber }}</button>
                {{ else }}
                <a href="{{ .URL }}" class="pagination-button pagination-button-secondary">{{ .PageNumber }}</a>
                {{ end }}
            {{ end }}
        {{ end }}
        
        <!-- Show last page if not in range -->
        {{ if lt $endPage $totalPages }}
        {{ if lt $endPage (sub $totalPages 1) }}
        <button class="pagination-button pagination-button-disabled">...</button>
        {{ end }}
        <a href="{{ (index $paginator.Pagers (sub $totalPages 1)).URL }}" class="pagination-button pagination-button-secondary">{{ $totalPages }}</a>
        {{ end }}
        
        {{ if $paginator.HasNext }}
        <a href="{{ $paginator.Next.URL }}" class="pagination-button pagination-button-secondary">
            Next
            <svg class="pagination-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
        {{ else }}
        <button class="pagination-button pagination-button-disabled">
            Next
            <svg class="pagination-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </button>
        {{ end }}
    </div>
</div>
{{ end }}